<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ultra-Pro 5D • Sari Jahe Premium</title>
<meta name="description" content="Ultra-Pro 5D demo + lengkap materi sari jahe: bahan, cara pembuatan, manfaat, download & print" />

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
/* ----------------------
   RESET & GLOBAL
   ---------------------- */
:root{
  --bg1: #0b1024; --bg2:#1b1f3a; --accent1:#00d0ff; --accent2:#7e5bff;
  --glass: rgba(255,255,255,0.06); --glass-strong: rgba(255,255,255,0.09);
  --card-shadow: 0 12px 30px rgba(12,12,20,0.6);
  --glass-border: rgba(255,255,255,0.12);
  --text: #eef2ff;
  --muted: rgba(255,255,255,0.75);
  --gold: linear-gradient(90deg,#f8b400,#ff6b00,#ff0a6c);
  --success: #32d583;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:'Poppins',system-ui,Segoe UI,Roboto,Helvetica,sans-serif;
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  background: linear-gradient(135deg,var(--bg1),var(--bg2));
  background-size:400% 400%;
  animation: bgMove 16s ease-in-out infinite;
  overflow-x:hidden;
}

/* animated multi-layer gradient */
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* ----------------------
   LAYOUT
   ---------------------- */
.container{max-width:1180px;margin:0 auto;padding:120px 24px 80px;position:relative}
nav{
  position:fixed;left:0;right:0;top:18px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;
  max-width:1180px;padding:12px 20px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));
  backdrop-filter: blur(10px);box-shadow:0 6px 25px rgba(2,6,23,0.5);border:1px solid rgba(255,255,255,0.06);z-index:999;
}
.brand{display:flex;align-items:center;gap:14px}
.logo{
  width:44px;height:44px;border-radius:10px;
  background: linear-gradient(135deg,#00eaff,#7e5bff);box-shadow:0 10px 30px rgba(125,85,255,0.12);
  display:flex;align-items:center;justify-content:center;font-weight:800;color:#04102a;
  transform:translateZ(40px) scale(1); /* give depth */
}
.brand h1{font-size:1rem;margin:0;letter-spacing:0.6px}
.navlinks{display:flex;align-items:center;gap:16px}
.navlinks a{color:var(--muted);text-decoration:none;font-weight:600;padding:8px 12px;border-radius:10px;transition:all .25s}
.navlinks a:hover{color:var(--text);transform:translateY(-3px)}

/* Toggle theme */
.theme-toggle{display:flex;align-items:center;gap:8px}
.switch{
  width:56px;height:30px;background:rgba(255,255,255,0.06);border-radius:999px;padding:4px;display:inline-flex;align-items:center;position:relative;border:1px solid rgba(255,255,255,0.06)
}
.knob{height:22px;width:22px;border-radius:999px;background:white;transform:translateX(0);transition:transform .25s;border:1px solid rgba(12,12,12,0.08)}

/* ----------------------
   OPENING OVERLAY
   ---------------------- */
#opening{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  background:linear-gradient(180deg,rgba(2,6,23,0.85),rgba(2,6,23,0.92));z-index:9999;
  transition:opacity .6s,visibility .6s;backdrop-filter: blur(6px)
}
#opening.hidden{opacity:0;visibility:hidden;pointer-events:none}
#opening .wrap{text-align:center;transform-style:preserve-3d}
#opening h2{
  font-size:44px;margin:0 0 10px;background:var(--gold);-webkit-background-clip:text;color:transparent;
  letter-spacing:2px;text-transform:uppercase
}
#opening p{color:rgba(255,255,255,0.85);opacity:.95}

/* ----------------------
   HERO (parallax layers)
   ---------------------- */
.hero{display:flex;gap:40px;align-items:center;padding:80px 0;position:relative}
.hero-left{flex:1;z-index:3}
.hero-left h2{font-size:48px;line-height:1.02;margin:0 0 12px;text-shadow:0 8px 30px rgba(8,10,30,0.6)}
.hero-left p{opacity:.9;font-size:1.05rem;margin-bottom:18px}
.btn-row{display:flex;gap:12px;align-items:center}
.btn{
  border:0;padding:14px 22px;border-radius:999px;font-weight:700;cursor:pointer;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:var(--card-shadow);
  color:#04102a;letter-spacing:0.3px;transition:transform .22s,box-shadow .22s
}
.btn.secondary{
  background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  color:var(--text);border:1px solid rgba(255,255,255,0.06)
}
.btn:hover{transform:translateY(-6px);box-shadow:0 18px 60px rgba(0,0,0,0.6)}

/* HERO RIGHT — layered 3D cards */
.hero-right{flex:1;display:grid;place-items:center;pointer-events:none}
.layer-wrap{width:360px;height:360px;position:relative;transform-style:preserve-3d;transition:transform .12s}
.layer{
  position:absolute;inset:0;border-radius:20px;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.06);backdrop-filter: blur(6px);
  box-shadow: 0 18px 50px rgba(6,8,30,0.6), inset 0 2px 12px rgba(255,255,255,0.02);
  transform-origin:center;display:flex;flex-direction:column;gap:10px;pointer-events:auto;
}
.layer .title{font-weight:700;font-size:1.1rem}
.layer .meta{font-size:.9rem;color:var(--muted)}

/* different z-depths */
.layer.l1{transform:translateZ(60px) rotateZ(-6deg)}
.layer.l2{transform:translateZ(30px) rotateZ(-2deg);left:14px;top:14px}
.layer.l3{transform:translateZ(0px);left:28px;top:28px}

/* ----------------------
   SECTION CARDS (cards & recipe)
   ---------------------- */
.section-title{font-size:28px;margin:40px 0 18px;background:linear-gradient(90deg,#00eaff,#7e5bff);-webkit-background-clip:text;color:transparent}
.grid{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:22px;
}
.card{
  background:rgba(255,255,255,0.04);border-radius:18px;padding:18px;border:1px solid rgba(255,255,255,0.06);
  box-shadow: inset 6px 6px 20px rgba(255,255,255,0.01), 0 10px 30px rgba(2,6,23,0.55);
  transition:transform .28s,box-shadow .28s;transform-style:preserve-3d;
}
.card:hover{transform:translateY(-14px) scale(1.02);box-shadow:0 28px 80px rgba(4,6,26,0.7)}
.card h3{margin:0 0 10px}
.card p{margin:0;color:var(--muted);line-height:1.45}

/* Sari Jahe special styling */
.recipe{
  display:grid;grid-template-columns:1fr 420px;gap:28px;align-items:start;margin-top:22px;
}
@media(max-width:980px){.recipe{grid-template-columns:1fr}}
.panel{
  background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  padding:20px;border-radius:14px;border:1px solid rgba(255,255,255,0.06);
  box-shadow: var(--card-shadow);
}
.ingredients li{margin:8px 0}
.steps li{margin:10px 0}
.recipe-hero{
  height:240px;border-radius:12px;background:
  radial-gradient(circle at 10% 20%, rgba(255,200,120,0.06), transparent 10%),
  linear-gradient(135deg,#3a2c6e, #7e5bff);
  display:flex;flex-direction:column;justify-content:center;padding:20px;color:white;
  box-shadow:inset 0 8px 40px rgba(0,0,0,0.25);
}

/* small helper */
.kv{display:flex;justify-content:space-between;gap:8px;margin-top:12px;font-weight:600}
.badge{display:inline-block;padding:8px 12px;border-radius:999px;background:rgba(255,255,255,0.04);font-weight:700}

/* print-friendly */
@media print{
  body{background:white;color:#111}
  nav,#opening,.btn,.theme-toggle{display:none}
  .container{padding:0}
  .recipe{grid-template-columns:1fr}
  .panel{border:none;box-shadow:none;background:transparent}
}

/* ----------------------
   DARK / LIGHT THEMES via attribute
   ---------------------- */
:root[data-theme='light']{
  --bg1:#f3f6ff;--bg2:#eef4ff;--text:#08203b;--muted:rgba(8,32,59,0.7);
  --glass: rgba(4,6,26,0.03);--glass-strong: rgba(4,6,26,0.05);--card-shadow:0 8px 30px rgba(10,18,35,0.08)
}
</style>
</head>
<body>

<!-- OPENING -->
<div id="opening" aria-hidden="false">
  <div class="wrap">
    <h2>WELCOME • ULTRA PRO 5D</h2>
    <p>Memuat antarmuka premium & materi lengkap Sari Jahe — dibuat otomatis</p>
  </div>
</div>

<!-- NAV -->
<nav>
  <div class="brand">
    <div class="logo">5D</div>
    <div>
      <h1>UltraPro 5D</h1>
      <div style="font-size:12px;color:rgba(255,255,255,0.65)">Kelas: Premium • Tema: Kantor & Sekolah</div>
    </div>
  </div>

  <div style="display:flex;align-items:center;gap:14px">
    <div class="navlinks" style="margin-right:8px">
      <a href="#home">Home</a>
      <a href="#features">Fitur</a>
      <a href="#sari-jahe">Sari Jahe</a>
      <a href="#contact">Contact</a>
    </div>

    <div class="theme-toggle" title="Toggle theme" role="button" tabindex="0" aria-label="Toggle theme">
      <div style="font-size:12px;color:rgba(255,255,255,0.7);margin-right:8px">Tema</div>
      <div class="switch" id="themeSwitch" aria-hidden="false"><div class="knob" id="themeKnob"></div></div>
    </div>
  </div>
</nav>

<!-- MAIN -->
<main class="container" id="home">

  <!-- HERO -->
  <section class="hero" id="features">
    <div class="hero-left">
      <h2>Desain 5D • Glassmorphism • Neumorphism • Parallax</h2>
      <p>Platform demo yang memadukan layer 3D, gradiasi premium, animasi halus, dan sekumpulan materi sari jahe lengkap — cocok untuk presentasi kantor / sekolah.</p>
      <div class="btn-row">
        <button class="btn" id="getStarted">Mulai</button>
        <button class="btn secondary" id="showRecipe">Lihat Sari Jahe</button>
      </div>
      <div style="margin-top:14px;color:var(--muted)">Tip: Gerakkan mouse di area kanan untuk efek 3D</div>
    </div>

    <div class="hero-right" id="parallaxArea" aria-hidden="true">
      <div class="layer-wrap" id="layerWrap">
        <div class="layer l1 panel">
          <div class="title">Glass Panel</div>
          <div class="meta">Efek reflektif • Kantor premium</div>
        </div>
        <div class="layer l2 panel">
          <div class="title">Neumorphism</div>
          <div class="meta">Efek timbul lembut</div>
        </div>
        <div class="layer l3 panel">
          <div class="title">Gradient Depth</div>
          <div class="meta">5D parallax • Mouse interactive</div>
        </div>
      </div>
    </div>
  </section>

  <!-- CARDS -->
  <section id="cardsSection">
    <h3 class="section-title">Fitur Utama</h3>
    <div class="grid">
      <div class="card">
        <h3>5D Glassmorphism</h3>
        <p>Lapisan kaca premium & blur yang memberikan kesan mewah, banyak dipakai website institusi.</p>
      </div>

      <div class="card">
        <h3>Neumorphism</h3>
        <p>Efek timbul lembut pada tombol & card untuk nuansa modern dan ramah pengguna.</p>
      </div>

      <div class="card">
        <h3>Parallax 3D</h3>
        <p>Layer bergerak mengikuti pointer, memberikan depth layaknya presentasi kantor.</p>
      </div>

      <div class="card">
        <h3>PWA Mini</h3>
        <p>Service worker dibuat otomatis (dari Blob) agar mudah dites: simpan & buka ulang untuk uji offline.</p>
      </div>
    </div>
  </section>

  <!-- SARI JAHE -->
  <section id="sari-jahe" style="margin-top:36px">
    <h3 class="section-title">Sari Jahe — Penjelasan Lengkap</h3>

    <div class="recipe" role="region" aria-labelledby="recipeTitle">
      <!-- main content -->
      <div>
        <div class="panel">
          <h2 id="recipeTitle" style="margin-top:0">Pengertian & Fungsi</h2>
          <p style="color:var(--muted)">
            <strong>Sari jahe</strong> adalah ekstrak rimpang jahe yang mengandung
            zat aktif seperti gingerol & shogaol — bersifat antioksidan, antiinflamasi, dan
            memiliki efek hangat. Sari jahe digunakan untuk menghangatkan tubuh,
            meredakan mual, memperlancar peredaran darah, serta sebagai minuman tradisional.
          </p>

          <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
            <div class="badge">Antioksidan</div>
            <div class="badge">Antiinflamasi</div>
            <div class="badge">Imunitas</div>
            <div class="badge">Pencernaan</div>
          </div>

          <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">

          <h4 style="margin-bottom:8px">Fungsi & Manfaat</h4>
          <ul style="color:var(--muted);line-height:1.6">
            <li>Menghangatkan tubuh & melancarkan peredaran darah.</li>
            <li>Membantu meredakan batuk, flu, dan masuk angin.</li>
            <li>Mengurangi mual, muntah, dan memperbaiki pencernaan.</li>
            <li>Memiliki sifat antimikroba & antiinflamasi.</li>
            <li>Membantu meredakan nyeri otot ringan.</li>
          </ul>

          <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">

          <h4>Bahan Pembuatan</h4>
          <ul class="ingredients" style="color:var(--muted)">
            <li>250 gram jahe segar (cuci bersih, geprek / parut)</li>
            <li>500–750 ml air (tergantung selera)</li>
            <li>3–4 sdm gula merah (atau gula pasir)</li>
            <li>1 batang serai (geprek) — opsional</li>
            <li>2 lembar daun pandan — opsional</li>
            <li>Madu asli (tambahkan saat hangat)</li>
            <li>Sejumput garam untuk penyedap</li>
          </ul>

          <h4 style="margin-top:12px">Langkah Pembuatan (Praktis)</h4>
          <ol class="steps" style="color:var(--muted);line-height:1.6">
            <li>Parut atau geprek jahe, keluarkan aroma. Jika ingin lebih kuat, gunakan parutan.</li>
            <li>Rebus air hingga hampir mendidih, masukkan jahe, serai, dan daun pandan.</li>
            <li>Tambahkan gula merah, kecilkan api, dan rebus 10–15 menit hingga aroma kuat.</li>
            <li>Saring ke dalam wadah bersih. Tambahkan madu saat hangat sesuai selera.</li>
            <li>Sajikan hangat atau simpan di kulkas (suhu dingin menambah rasa segar saat diminum dingin).</li>
          </ol>

          <div style="display:flex;gap:10px;margin-top:14px">
            <button class="btn" id="printRecipe">Print Recipe</button>
            <button class="btn secondary" id="downloadIngredients">Download Bahan</button>
            <button class="btn secondary" id="toggleDetails">Tampilkan Tips & Variasi</button>
          </div>

          <div id="extraTips" style="margin-top:12px;display:none">
            <h4>Tips & Variasi</h4>
            <ul style="color:var(--muted);line-height:1.6">
              <li>Untuk sari jahe pekat, gunakan perbandingan jahe:air 1:1 (misal 250g jahe:250ml air) lalu encerkan saat disajikan.</li>
              <li>Variasi: tambahkan perasan lemon atau jeruk nipis untuk rasa segar.</li>
              <li>Untuk rasa pedas lebih terasa, gunakan parutan jahe tanpa dikupas.</li>
              <li>Simpan di kulkas hingga 5–7 hari dalam wadah kedap udara.</li>
            </ul>
          </div>

        </div>

        <!-- Kandungan & Penjelasan -->
        <div style="display:flex;gap:12px;margin-top:18px;flex-wrap:wrap">
          <div class="panel" style="flex:1;min-width:220px">
            <h4>Kandungan Aktif</h4>
            <p style="color:var(--muted)">Gingerol, shogaol, zingerone — berfungsi sebagai antioksidan & antiperadangan. Kandungan minyak atsiri memberikan aroma dan efek hangat.</p>
          </div>
          <div class="panel" style="width:260px;min-width:200px">
            <h4>Perhatian</h4>
            <p style="color:var(--muted)">Hindari konsumsi berlebihan pada ibu hamil tanpa konsultasi, atau jika sedang konsumsi obat pengencer darah. Konsultasikan dengan tenaga medis jika ragu.</p>
          </div>
        </div>
      </div>

      <!-- side panel -->
      <aside>
        <div class="recipe-hero panel" style="position:relative;overflow:hidden">
          <div style="font-weight:800;font-size:20px">Sari Jahe Premium</div>
          <div style="margin-top:8px;color:rgba(255,255,255,0.9)">Resep praktis & tips untuk tampilan produk herbal premium.</div>
          <div class="kv" style="margin-top:12px">
            <div>Waktu</div><div>20–30 menit</div>
          </div>
          <div class="kv">
            <div>Hasil</div><div>~600–800 ml (tergantung encer)</div>
          </div>
        </div>

        <div style="height:18px"></div>

        <div class="panel">
          <h4>Elemen Produk</h4>
          <ul style="color:var(--muted);line-height:1.5">
            <li>Botol kaca 250ml • label premium</li>
            <li>QR code untuk nutrisi & cara pakai</li>
            <li>Kemas ramah lingkungan</li>
          </ul>
        </div>

        <div style="height:18px"></div>

        <div class="panel">
          <h4>Download</h4>
          <p style="color:var(--muted)">Gunakan tombol untuk mengunduh bahan sebagai file teks (untuk cetak label) atau cetak resep.</p>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn" id="downloadLabel">Download Label (TXT)</button>
            <button class="btn secondary" id="downloadCard">Download Card</button>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- CONTACT / FOOTER -->
  <section id="contact" style="margin-top:56px">
    <h3 class="section-title">Hubungi / Footer</h3>
    <div style="display:flex;gap:18px;flex-wrap:wrap">
      <div class="panel" style="flex:1">
        <h4>Kontak</h4>
        <p style="color:var(--muted)">Email: info@ultrapro5d.example • Telp: +62 812-3456-7890</p>
      </div>

      <div class="panel" style="width:280px">
        <h4>About</h4>
        <p style="color:var(--muted)">Demo interface modern untuk presentasi kantor & sekolah. Semua fitur termasuk resep sari jahe dibuat komprehensif.</p>
      </div>
    </div>
  </section>

</main>

<!-- small unobtrusive script area -->
<script>
/* ----------------------
   Helper & INIT
   ---------------------- */
(function(){
  // Elements
  const opening = document.getElementById('opening');
  const getStarted = document.getElementById('getStarted');
  const showRecipe = document.getElementById('showRecipe');
  const printBtn = document.getElementById('printRecipe');
  const downloadIng = document.getElementById('downloadIngredients');
  const toggleDetailsBtn = document.getElementById('toggleDetails');
  const extraTips = document.getElementById('extraTips');
  const downloadLabel = document.getElementById('downloadLabel');
  const downloadCard = document.getElementById('downloadCard');
  const themeSwitch = document.getElementById('themeSwitch');
  const themeKnob = document.getElementById('themeKnob');
  const body = document.documentElement;

  // close opening after delay & allow instant close on click
  setTimeout(()=>{ opening.classList.add('hidden') }, 2300);
  opening.addEventListener('click', ()=> opening.classList.add('hidden'));

  // scroll focus to recipe
  showRecipe.addEventListener('click', ()=> {
    document.getElementById('sari-jahe').scrollIntoView({behavior:'smooth',block:'center'});
  });
  getStarted.addEventListener('click', ()=> {
    document.getElementById('features').scrollIntoView({behavior:'smooth'});
  });

  // print recipe
  printBtn.addEventListener('click', ()=> window.print());

  // download ingredients as text file
  downloadIng.addEventListener('click', ()=>{
    const text = [
      'Daftar Bahan Sari Jahe (Resep Premium)',
      '-------------------------------------',
      '250 gram jahe segar (cuci bersih, geprek / parut)',
      '500–750 ml air',
      '3–4 sdm gula merah (atau gula pasir)',
      '1 batang serai (opsional)',
      '2 lembar daun pandan (opsional)',
      'Madu sesuai selera',
      'Sejumput garam',
      '',
      'Langkah singkat: Rebus jahe + air + gula + serai selama 10-15 menit. Saring. Tambah madu saat hangat.'
    ].join('\\n');
    const blob = new Blob([text], {type:'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'bahan_sari_jahe.txt';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  });

  // download label (txt) — basic template
  downloadLabel.addEventListener('click', ()=>{
    const label = [
      '=== LABEL PRODUK SARI JAHE PREMIUM ===',
      'Nama Produk: Sari Jahe Premium',
      'Netto: 250 ml',
      'Bahan: Jahe, gula merah, serai, daun pandan, madu (opsional)',
      'Produsen: UltraPro 5D Demo',
      'Tanggal produksi: [isi tanggal]',
      'Cara penyajian: Panaskan, tambahkan madu bila suka.',
      '',
      'Catatan: Simpan di kulkas. Konsultasi dokter jika hamil atau sedang konsumsi obat.'
    ].join('\\n');
    const blob = new Blob([label], {type:'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'label_sari_jahe.txt';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  });

  // download card: small html snippet
  downloadCard.addEventListener('click', ()=>{
    const htmlCard = [
      '<div style="font-family:sans-serif;padding:12px;border-radius:8px;border:1px solid #ddd">',
      '<h3>Sari Jahe Premium</h3>',
      '<p>Netto: 250 ml • Hangatkan sebelum minum</p>',
      '<p>Bahan: Jahe, gula merah, serai, daun pandan, madu</p>',
      '</div>'
    ].join('');
    const blob = new Blob([htmlCard], {type:'text/html;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'card_sari_jahe.html';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  });

  // toggle details
  toggleDetailsBtn.addEventListener('click', ()=>{
    const show = extraTips.style.display === 'block';
    extraTips.style.display = show ? 'none' : 'block';
    toggleDetailsBtn.textContent = show ? 'Tampilkan Tips & Variasi' : 'Sembunyikan Tips & Variasi';
  });

  // THEME toggle with localStorage
  const preferred = localStorage.getItem('ultra_theme') || 'dark';
  if(preferred === 'light') applyTheme('light'); else applyTheme('dark');

  themeSwitch.addEventListener('click', ()=>{
    const current = document.documentElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
    applyTheme(current === 'light' ? 'dark' : 'light');
  });

  function applyTheme(name){
    if(name === 'light'){
      document.documentElement.setAttribute('data-theme','light');
      themeKnob.style.transform = 'translateX(26px)';
      localStorage.setItem('ultra_theme','light');
    } else {
      document.documentElement.setAttribute('data-theme','dark');
      themeKnob.style.transform = 'translateX(0)';
      localStorage.setItem('ultra_theme','dark');
    }
  }

  // simple parallax effect for layerWrap
  const layerWrap = document.getElementById('layerWrap');
  const parallaxArea = document.getElementById('parallaxArea');
  parallaxArea.addEventListener('mousemove', (e)=>{
    const rect = parallaxArea.getBoundingClientRect();
    const x = (e.clientX - rect.left) / rect.width - 0.5;
    const y = (e.clientY - rect.top) / rect.height - 0.5;
    layerWrap.style.transform = `rotateX(${y * 6}deg) rotateY(${x * 12}deg) translateZ(0)`;
  });
  parallaxArea.addEventListener('mouseleave', ()=> layerWrap.style.transform = 'rotateX(0) rotateY(0)');

  // Smooth scroll for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', (ev)=>{
      ev.preventDefault();
      const id = a.getAttribute('href').slice(1);
      const el = document.getElementById(id);
      if(el) el.scrollIntoView({behavior:'smooth',block:'center'});
    })
  });

  // Register a tiny service worker using Blob to simulate PWA capability
  if('serviceWorker' in navigator){
    const swCode = `
      self.addEventListener('install', event => {
        event.waitUntil(self.skipWaiting());
      });
      self.addEventListener('activate', event => {
        event.waitUntil(self.clients.claim());
      });
      self.addEventListener('fetch', event => {
        // Basic caching strategy: try network, fallback to cache
        event.respondWith(fetch(event.request).catch(() => caches.match(event.request)));
      });
    `;
    const blob = new Blob([swCode], {type:'application/javascript'});
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl).then(reg => {
      console.log('Service worker registered (blob). Scope:', reg.scope);
    }).catch(err => {
      console.warn('SW register failed', err);
    });
  }
})(); // end IIFE
</script>

</body>
</html>
